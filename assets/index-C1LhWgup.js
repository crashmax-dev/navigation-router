(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();function r(i,e,...t){const o=document.createElement(i);return e instanceof Node?o.append(e):typeof e=="string"?o.append(l(e)):Array.isArray(e)?o.append(...e):(Object.assign(o,e),Object.assign(o.style,e?.style)),o.append(...t),o}function l(i){return document.createTextNode(i)}function h(i){return i.replace(/:([^/]+)/g,":$1")}class p{config;routes=new Map;routesByName=new Map;urlPatterns=new Map;currentRoute;currentElement;navigation;navigationLinks=new Map;constructor(e){if(this.config=e,typeof window.navigation>"u")throw new TypeError("Navigation API is not available");this.navigation=window.navigation,this.init()}init(){for(const e of this.config.routes){const t=new e;this.routes.set(t.props.path,t),t.props.name&&this.routesByName.set(t.props.name,t);const o=h(t.props.path),n=new URLPattern({pathname:o});this.urlPatterns.set(n,t)}this.renderNavigation(),this.navigation.addEventListener("navigate",e=>{!e.canIntercept||e.hashChange||e.downloadRequest||e.intercept({handler:async()=>{await this.handleNavigation(e.destination.url)}})}),this.handleNavigation(window.location.href)}renderNavigation(){const e=this.config.navigationRoot();if(!e){console.warn("[renderNavigation] Navigation container not found");return}e.innerHTML="",this.navigationLinks.clear();for(const t of this.routes.values()){if(t.props.path.includes(":"))continue;const o=this.config.navigationRenderLink(t),n=o instanceof HTMLAnchorElement?o:o.querySelector("a");n&&(n.textContent=t.props.label||t.props.name||t.props.path),this.navigationLinks.set(t.props.path,n||o),e.appendChild(o)}}async handleNavigation(e){const t=this.config.renderRoot();if(!t){console.warn("[handleNavigation] Root container not found");return}const o=new URL(e),n=this.findRoute(o);if(!n){console.warn("[handleNavigation] Route not found:",o);return}const a={query:Object.fromEntries(o.searchParams),params:n.params,router:this};this.currentRoute?.unmount&&this.currentRoute.unmount();const s=n.route.mount(a)??n.route.el;if(!s){console.warn("[handleNavigation] Route element is not defined:",n.route.props);return}this.currentElement&&(this.currentRoute.el=void 0,t.removeChild(this.currentElement)),t.appendChild(s),this.currentRoute=n.route,this.currentElement=s,this.updateActiveLink()}updateActiveLink(){this.navigationLinks.forEach((e,t)=>{t===this.currentRoute?.props.path?e.classList.add("active"):e.classList.remove("active")})}findRoute(e){for(const[t,o]of this.urlPatterns.entries()){const n=t.exec(e.href);if(n)return{route:o,params:n.pathname.groups}}}push(e){this.navigation.navigate(e)}replace(e){this.navigation.navigate(e,{history:"replace"})}back(){this.navigation.back()}forward(){this.navigation.forward()}getUnsafe(e){let t;if("name"in e?t=this.routesByName.get(e.name):t=this.routes.get(e.path),!t){console.warn("[getUnsafe] Route not found:",e);return}return t}}function d(i){return new p(i)}class c{el;props;constructor(e){this.props=e}}class f extends c{constructor(){super({path:"/about",label:"About"})}mount(e){return r("div",[r("h1","About Page"),r("p","This is the about page."),r("pre",`Timestamp: ${e.query.timestamp}`),r("button",{onclick(){e.router.back()}},"Go back")])}}class m extends c{constructor(){super({path:"/blog/:id"})}mount(e){const t=e.params.id;this.el=r("div",[r("h1","Blog Page"),r("p",`Blog ID: ${t}`),r("button",{onclick(){e.router.back()}},"Go back"),r("button",{onclick(){e.router.push(`/blog/${Number(t)+1}`)}},"Go to next blog")])}}class g extends c{cursorPointer;constructor(){super({path:"/",label:"Home"}),this.handleClick=this.handleClick.bind(this),this.handleMove=this.handleMove.bind(this)}handleClick(){console.info("Home clicked!")}handleMove(e){this.cursorPointer.textContent=`x: ${e.clientX} y: ${e.clientY}`,console.log("Mouse moved! ðŸŽ‰")}mount(e){this.cursorPointer=r("pre","x: 0 y: 0"),this.el=r("div",[r("h1","Home Page"),r("p","Welcome back!"),this.cursorPointer,r("div",[r("button",{onclick:this.handleClick},"Click me!"),r("button",{onclick(){e.router.push(`/about?timestamp=${Date.now()}`)}},"Go to About"),r("button",{onclick(){e.router.push("/blog/1")}},"Go to Blog")])]),document.body.addEventListener("mousemove",this.handleMove)}unmount(){document.body.removeEventListener("mousemove",this.handleMove)}}const u=d({routes:[g,f,m],renderRoot:()=>document.querySelector("#app"),navigationRoot:()=>document.querySelector("#navigation"),navigationRenderLink:i=>r("a",{href:i.props.path,className:"link"})});console.log(u);window.$router=u;
