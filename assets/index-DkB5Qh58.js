(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function n(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(s){if(s.ep)return;s.ep=!0;const c=n(s);fetch(s.href,c)}})();function i(t,e,...n){const a=document.createElement(t);return e instanceof Node?a.append(e):typeof e=="string"?a.append(I(e)):Array.isArray(e)?a.append(...e):(Object.assign(a,e),Object.assign(a.style,e?.style)),a.append(...n),a}function I(t){return document.createTextNode(t)}class O{getLocation(){const e=window.location.hash.slice(1);return e.startsWith("/")?e:`/${e}`}listen(e){const n=()=>{e(this.getLocation())};return window.addEventListener("hashchange",n),()=>window.removeEventListener("hashchange",n)}navigate(e,n){const a=this.createHref(e);if(n){const s=window.location.href.split("#")[0];window.location.replace(s+a)}else window.location.hash=e}go(e){window.history.go(e)}createHref(e){return`#${e}`}}function $({update:t,notify:e,unwatched:n}){return{link:a,unlink:s,propagate:c,checkDirty:h,shallowPropagate:x};function a(o,u,l){const d=u.depsTail;if(d!==void 0&&d.dep===o)return;const r=d!==void 0?d.nextDep:u.deps;if(r!==void 0&&r.dep===o){r.version=l,u.depsTail=r;return}const f=o.subsTail;if(f!==void 0&&f.version===l&&f.sub===u)return;const p=u.depsTail=o.subsTail={version:l,dep:o,sub:u,prevDep:d,nextDep:r,prevSub:f,nextSub:void 0};r!==void 0&&(r.prevDep=p),d!==void 0?d.nextDep=p:u.deps=p,f!==void 0?f.nextSub=p:o.subs=p}function s(o,u=o.sub){const l=o.dep,d=o.prevDep,r=o.nextDep,f=o.nextSub,p=o.prevSub;return r!==void 0?r.prevDep=d:u.depsTail=d,d!==void 0?d.nextDep=r:u.deps=r,f!==void 0?f.prevSub=p:l.subsTail=p,p!==void 0?p.nextSub=f:(l.subs=f)===void 0&&n(l),r}function c(o){let u=o.nextSub,l;e:do{const d=o.sub;let r=d.flags;if(r&60?r&12?r&4?!(r&48)&&A(o,d)?(d.flags=r|40,r&=1):r=0:d.flags=r&-9|32:r=0:d.flags=r|32,r&2&&e(d),r&1){const f=d.subs;if(f!==void 0){const p=(o=f).nextSub;p!==void 0&&(l={value:u,prev:l},u=p);continue}}if((o=u)!==void 0){u=o.nextSub;continue}for(;l!==void 0;)if(o=l.value,l=l.prev,o!==void 0){u=o.nextSub;continue e}break}while(!0)}function h(o,u){let l,d=0,r=!1;e:do{const f=o.dep,p=f.flags;if(u.flags&16)r=!0;else if((p&17)===17){if(t(f)){const g=f.subs;g.nextSub!==void 0&&x(g),r=!0}}else if((p&33)===33){(o.nextSub!==void 0||o.prevSub!==void 0)&&(l={value:o,prev:l}),o=f.deps,u=f,++d;continue}if(!r){const g=o.nextDep;if(g!==void 0){o=g;continue}}for(;d--;){const g=u.subs,D=g.nextSub!==void 0;if(D?(o=l.value,l=l.prev):o=g,r){if(t(u)){D&&x(g),u=o.sub;continue}r=!1}else u.flags&=-33;u=o.sub;const T=o.nextDep;if(T!==void 0){o=T;continue e}}return r}while(!0)}function x(o){do{const u=o.sub,l=u.flags;(l&48)===32&&(u.flags=l|16,(l&6)===2&&e(u))}while((o=o.nextSub)!==void 0)}function A(o,u){let l=u.depsTail;for(;l!==void 0;){if(l===o)return!0;l=l.prevDep}return!1}}let R=0,v=0,y=0,m;const b=[],{link:N,unlink:k,propagate:q,checkDirty:H,shallowPropagate:V}=$({update(t){return t.depsTail!==void 0?U(t):M(t)},notify(t){let e=y,n=e;do if(b[e++]=t,t.flags&=-3,t=t.subs?.sub,t===void 0||!(t.flags&2))break;while(!0);for(y=e;n<--e;){const a=b[n];b[n++]=b[e],b[e]=a}},unwatched(t){t.flags&1?t.depsTail!==void 0&&(t.depsTail=void 0,t.flags=17,w(t)):C.call(t)}});function P(t){const e=m;return m=t,e}function S(t){return K.bind({currentValue:t,pendingValue:t,subs:void 0,subsTail:void 0,flags:1})}function B(t){const e={fn:t,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:6},n=P(e);n!==void 0&&N(e,n,0);try{e.fn()}finally{m=n,e.flags&=-5}return W.bind(e)}function U(t){++R,t.depsTail=void 0,t.flags=5;const e=P(t);try{const n=t.value;return n!==(t.value=t.getter(n))}finally{m=e,t.flags&=-5,w(t)}}function M(t){return t.flags=1,t.currentValue!==(t.currentValue=t.pendingValue)}function j(t){const e=t.flags;if(e&16||e&32&&H(t.deps,t)){++R,t.depsTail=void 0,t.flags=6;const n=P(t);try{t.fn()}finally{m=n,t.flags&=-5,w(t)}}else t.flags=2}function G(){try{for(;v<y;){const t=b[v];b[v++]=void 0,j(t)}}finally{for(;v<y;){const t=b[v];b[v++]=void 0,t.flags|=10}v=0,y=0}}function K(...t){if(t.length){if(this.pendingValue!==(this.pendingValue=t[0])){this.flags=17;const e=this.subs;e!==void 0&&(q(e),G())}}else{if(this.flags&16&&M(this)){const n=this.subs;n!==void 0&&V(n)}let e=m;for(;e!==void 0;){if(e.flags&3){N(this,e,R);break}e=e.subs?.sub}return this.currentValue}}function W(){C.call(this)}function C(){this.depsTail=void 0,this.flags=0,w(this);const t=this.subs;t!==void 0&&k(t)}function w(t){const e=t.depsTail;let n=e!==void 0?e.nextDep:t.deps;for(;n!==void 0;)n=k(n,t)}function F(t){return t.replace(/:([^/]+)/g,":$1")}class Q{config;adapter;routes=new Map;routesByName=new Map;urlPatterns=new Map;currentRoute=null;currentRouteDisposers=[];navigationLinks=new Map;constructor(e){this.config=e,this.adapter=e.adapter,this.init()}init(){for(const e of this.config.routes){const n=new e;this.routes.set(n.props.path,n),n.props.name&&this.routesByName.set(n.props.name,n);const a=F(n.props.path),s=new URLPattern({pathname:a});this.urlPatterns.set(s,n)}this.renderNavigation(),this.adapter.listen(e=>{this.handleNavigation(e)}),this.handleNavigation(this.adapter.getLocation())}renderNavigation(){const e=this.config.navigationRoot();if(!e){console.warn("[renderNavigation] Navigation container not found");return}e.innerHTML="",this.navigationLinks.clear();for(const n of this.routes.values()){if(n.props.path.includes(":"))continue;const a=this.config.navigationRenderLink(n),s=a instanceof HTMLAnchorElement?a:a.querySelector("a");s&&(s.href=this.adapter.createHref(n.props.path),s.textContent=n.props.label||n.props.name||n.props.path,s.addEventListener("click",c=>{c.ctrlKey||c.metaKey||c.altKey||c.shiftKey||(c.preventDefault(),this.push(n.props.path))}),n.onLinkMouseEnter&&s.addEventListener("mouseenter",c=>{n.onLinkMouseEnter(c)}),n.onLinkMouseLeave&&s.addEventListener("mouseleave",c=>{n.onLinkMouseLeave(c)})),this.navigationLinks.set(n.props.path,s||a),e.appendChild(a)}}async handleNavigation(e){const n=this.config.renderRoot();if(!n){console.warn("[handleNavigation] Root container not found");return}const a=new URL(e,location.origin),s=this.findRoute(a);if(!s){console.warn("[handleNavigation] Route not found:",a);return}const c={query:Object.fromEntries(a.searchParams),params:s.params,router:this};this.currentRoute?.unmount&&this.currentRoute.unmount(),this.currentRouteDisposers.forEach(h=>h()),this.currentRouteDisposers=[],s.route.setup&&await s.route.setup(c),this.currentRouteDisposers.push(B(async()=>{const h=s.route.render(c)??s.route.el;h&&n.replaceChildren(h)})),this.currentRoute=s.route,this.updateActiveLink()}updateActiveLink(){for(const[e,n]of this.navigationLinks.entries())e===this.currentRoute?.props.path?n.classList.add("active"):n.classList.remove("active")}findRoute(e){for(const[n,a]of this.urlPatterns.entries()){const s=n.exec({pathname:e.pathname});if(s)return{route:a,params:s.pathname.groups}}}push(e){this.adapter.navigate(e)}replace(e){this.adapter.navigate(e,!0)}back(){this.adapter.go(-1)}forward(){this.adapter.go(1)}getUnsafe(e){let n;if("name"in e?n=this.routesByName.get(e.name):n=this.routes.get(e.path),!n){console.warn("[getUnsafe] Route not found:",e);return}return n}}function X(t){return new Q(t)}class L{el;props;constructor(e){this.props=e}}class Y extends L{constructor(){super({path:"/about",label:"About"})}render(e){return i("div",[i("h1","About Page"),i("p","This is the about page."),i("pre",`Timestamp: ${e.query.timestamp}`),i("button",{onclick(){e.router.back()}},"Go back")])}}class _ extends L{constructor(){super({path:"/blog/:id"})}render(e){const n=e.params.id;return i("div",[i("h1","Blog Page"),i("p",`Blog ID: ${n}`),i("div",{className:"buttons"},i("button",{onclick(){e.router.back()}},"Go back"),i("button",{onclick(){e.router.push(`/blog/${Number(n)+1}`)}},"Go to next blog"))])}}class z extends L{cursorPointer;constructor(){super({path:"/",label:"Home"}),this.handleClick=this.handleClick.bind(this),this.handleMove=this.handleMove.bind(this)}handleClick(){console.info("Home clicked!")}handleMove(e){this.cursorPointer.textContent=`x: ${e.clientX} y: ${e.clientY}`,console.log("Mouse moved! ðŸŽ‰")}setup(){this.cursorPointer=i("pre","x: 0 y: 0"),document.body.addEventListener("mousemove",this.handleMove)}render(e){return i("div",[i("h1","Home Page"),i("p","Welcome back!"),this.cursorPointer,i("div",{className:"buttons"},i("button",{onclick:this.handleClick},"Click me!"),i("button",{onclick:()=>{e.router.push(`/about?timestamp=${Date.now()}`)}},"Go to About"),i("button",{onclick:()=>{e.router.push("/blog/1")}},"Go to Blog"))])}unmount(){document.body.removeEventListener("mousemove",this.handleMove)}}class J extends L{posts=S([]);loading=S(!1);page=S(1);abortController;constructor(){super({path:"/posts",label:"Posts"})}setup(){this.fetchPosts()}render(){const e=this.posts(),n=this.page(),a=this.loading();return i("div",[i("h1","Posts"),i("div",{className:"buttons"},i("button",{disabled:n===1,onclick:()=>{this.page(n-1),this.fetchPosts()}},"Previous Page"),i("span",`Page: ${n}`),i("button",{disabled:n===10,onclick:()=>{this.page(n+1),this.fetchPosts()}},"Next Page"),a?i("span","Loading..."):"",i("button",{style:{marginLeft:"auto"},onclick:()=>{this.posts([{id:Math.floor(Math.random()*100),userId:1,title:"qui est esse",body:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Quas, quia."},...e])}},"Add Post")),i("table",{className:"posts-table"},i("thead",[i("tr",[i("th","ID"),i("th","User ID"),i("th","Title"),i("th","Body")])]),i("tbody",e.map(s=>i("tr",[i("td",String(s.id)),i("td",String(s.userId)),i("td",s.title),i("td",s.body)]))))])}async fetchPosts(){if(!this.loading()){this.abortController=new AbortController,this.loading(!0);try{const e=await fetch(`https://jsonplaceholder.typicode.com/posts?_page=${this.page()}`,{signal:this.abortController.signal});e.ok&&(this.posts(await e.json()),this.abortController=void 0)}finally{this.loading(!1)}}}onLinkMouseEnter(){this.fetchPosts()}unmount(){this.abortController&&(this.abortController.abort(),this.abortController=void 0)}}const E=X({adapter:new O,routes:[z,Y,_,J],renderRoot:()=>document.querySelector("#app"),navigationRoot:()=>document.querySelector("#navigation"),navigationRenderLink:()=>i("a",{className:"link"})});console.log(E);window.$router=E;
