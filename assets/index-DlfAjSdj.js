(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}})();function i(t,e,n){const r=document.createElement(t);return e instanceof Node?r.append(e):typeof e=="string"?r.append(k(e)):Array.isArray(e)?r.append(...e):e&&(Object.assign(r,e),Object.assign(r.style,e?.style)),n!==void 0&&(Array.isArray(n)?r.append(...n):n instanceof Node?r.append(n):typeof n=="string"&&r.append(k(n))),r}function k(t){return document.createTextNode(t)}class I{getLocation(){const e=window.location.hash.slice(1);return e.startsWith("/")?e:`/${e}`}listen(e){const n=()=>{e(this.getLocation())};return window.addEventListener("hashchange",n),()=>window.removeEventListener("hashchange",n)}navigate(e,n){const r=this.createHref(e);if(n){const o=window.location.href.split("#")[0];window.location.replace(o+r)}else window.location.hash=e}go(e){window.history.go(e)}createHref(e){return`#${e}`}}function O({update:t,notify:e,unwatched:n}){return{link:r,unlink:o,propagate:u,checkDirty:h,shallowPropagate:R};function r(s,l,c){const d=l.depsTail;if(d!==void 0&&d.dep===s)return;const a=d!==void 0?d.nextDep:l.deps;if(a!==void 0&&a.dep===s){a.version=c,l.depsTail=a;return}const f=s.subsTail;if(f!==void 0&&f.version===c&&f.sub===l)return;const p=l.depsTail=s.subsTail={version:c,dep:s,sub:l,prevDep:d,nextDep:a,prevSub:f,nextSub:void 0};a!==void 0&&(a.prevDep=p),d!==void 0?d.nextDep=p:l.deps=p,f!==void 0?f.nextSub=p:s.subs=p}function o(s,l=s.sub){const c=s.dep,d=s.prevDep,a=s.nextDep,f=s.nextSub,p=s.prevSub;return a!==void 0?a.prevDep=d:l.depsTail=d,d!==void 0?d.nextDep=a:l.deps=a,f!==void 0?f.prevSub=p:c.subsTail=p,p!==void 0?p.nextSub=f:(c.subs=f)===void 0&&n(c),a}function u(s){let l=s.nextSub,c;e:do{const d=s.sub;let a=d.flags;if(a&60?a&12?a&4?!(a&48)&&q(s,d)?(d.flags=a|40,a&=1):a=0:d.flags=a&-9|32:a=0:d.flags=a|32,a&2&&e(d),a&1){const f=d.subs;if(f!==void 0){const p=(s=f).nextSub;p!==void 0&&(c={value:l,prev:c},l=p);continue}}if((s=l)!==void 0){l=s.nextSub;continue}for(;c!==void 0;)if(s=c.value,c=c.prev,s!==void 0){l=s.nextSub;continue e}break}while(!0)}function h(s,l){let c,d=0,a=!1;e:do{const f=s.dep,p=f.flags;if(l.flags&16)a=!0;else if((p&17)===17){if(t(f)){const g=f.subs;g.nextSub!==void 0&&R(g),a=!0}}else if((p&33)===33){(s.nextSub!==void 0||s.prevSub!==void 0)&&(c={value:s,prev:c}),s=f.deps,l=f,++d;continue}if(!a){const g=s.nextDep;if(g!==void 0){s=g;continue}}for(;d--;){const g=l.subs,D=g.nextSub!==void 0;if(D?(s=c.value,c=c.prev):s=g,a){if(t(l)){D&&R(g),l=s.sub;continue}a=!1}else l.flags&=-33;l=s.sub;const T=s.nextDep;if(T!==void 0){s=T;continue e}}return a}while(!0)}function R(s){do{const l=s.sub,c=l.flags;(c&48)===32&&(l.flags=c|16,(c&6)===2&&e(l))}while((s=s.nextSub)!==void 0)}function q(s,l){let c=l.depsTail;for(;c!==void 0;){if(c===s)return!0;c=c.prevDep}return!1}}let S=0,v=0,y=0,m;const b=[],{link:M,unlink:N,propagate:$,checkDirty:H,shallowPropagate:V}=O({update(t){return t.depsTail!==void 0?j(t):C(t)},notify(t){let e=y,n=e;do if(b[e++]=t,t.flags&=-3,t=t.subs?.sub,t===void 0||!(t.flags&2))break;while(!0);for(y=e;n<--e;){const r=b[n];b[n++]=b[e],b[e]=r}},unwatched(t){t.flags&1?t.depsTail!==void 0&&(t.depsTail=void 0,t.flags=17,w(t)):A.call(t)}});function P(t){const e=m;return m=t,e}function x(t){return K.bind({currentValue:t,pendingValue:t,subs:void 0,subsTail:void 0,flags:1})}function U(t){const e={fn:t,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:6},n=P(e);n!==void 0&&M(e,n,0);try{e.fn()}finally{m=n,e.flags&=-5}return W.bind(e)}function j(t){++S,t.depsTail=void 0,t.flags=5;const e=P(t);try{const n=t.value;return n!==(t.value=t.getter(n))}finally{m=e,t.flags&=-5,w(t)}}function C(t){return t.flags=1,t.currentValue!==(t.currentValue=t.pendingValue)}function B(t){const e=t.flags;if(e&16||e&32&&H(t.deps,t)){++S,t.depsTail=void 0,t.flags=6;const n=P(t);try{t.fn()}finally{m=n,t.flags&=-5,w(t)}}else t.flags=2}function G(){try{for(;v<y;){const t=b[v];b[v++]=void 0,B(t)}}finally{for(;v<y;){const t=b[v];b[v++]=void 0,t.flags|=10}v=0,y=0}}function K(...t){if(t.length){if(this.pendingValue!==(this.pendingValue=t[0])){this.flags=17;const e=this.subs;e!==void 0&&($(e),G())}}else{if(this.flags&16&&C(this)){const n=this.subs;n!==void 0&&V(n)}let e=m;for(;e!==void 0;){if(e.flags&3){M(this,e,S);break}e=e.subs?.sub}return this.currentValue}}function W(){A.call(this)}function A(){this.depsTail=void 0,this.flags=0,w(this);const t=this.subs;t!==void 0&&N(t)}function w(t){const e=t.depsTail;let n=e!==void 0?e.nextDep:t.deps;for(;n!==void 0;)n=N(n,t)}function F(t){return t.replace(/:([^/]+)/g,":$1")}class Q{config;adapter;routes=new Map;urlPatterns=new Map;currentRoute=null;currentRouteDisposers=[];navigationLinks=new Map;constructor(e){this.config=e,this.adapter=e.adapter,this.init()}init(){for(const e of this.config.routes){const n=new e;this.routes.set(n.props.path,n);const r=F(n.props.path),o=new URLPattern({pathname:r});this.urlPatterns.set(o,n)}this.renderNavigation(),this.adapter.listen(e=>{this.handleNavigation(e)}),this.handleNavigation(this.adapter.getLocation())}renderNavigation(){const e=this.config.navigationRoot();if(!e){console.warn("[renderNavigation] Navigation container not found");return}e.innerHTML="",this.navigationLinks.clear();for(const n of this.routes.values()){if(n.props.path.includes(":"))continue;const r=this.config.navigationRenderLink(n),o=r instanceof HTMLAnchorElement?r:r.querySelector("a");o&&(o.href=this.adapter.createHref(n.props.path),o.textContent=n.props.label||n.props.path,o.addEventListener("click",u=>{u.ctrlKey||u.metaKey||u.altKey||u.shiftKey||(u.preventDefault(),this.push(n.props.path))}),n.onLinkMouseEnter&&o.addEventListener("mouseenter",u=>{n.onLinkMouseEnter(u)}),n.onLinkMouseLeave&&o.addEventListener("mouseleave",u=>{n.onLinkMouseLeave(u)})),this.navigationLinks.set(n.props.path,o||r),e.appendChild(r)}}async handleNavigation(e){const n=this.config.renderRoot();if(!n){console.warn("[handleNavigation] Root container not found");return}const r=new URL(e,location.origin),o=this.findRoute(r);if(!o){console.warn("[handleNavigation] Route not found:",r);return}const u={query:Object.fromEntries(r.searchParams),params:o.params,router:this};this.currentRoute?.unmount&&this.currentRoute.unmount(),this.currentRouteDisposers.forEach(h=>h()),this.currentRouteDisposers=[],o.route.setup&&await o.route.setup(u),this.currentRouteDisposers.push(U(async()=>{const h=o.route.render(u)??o.route.el;h&&n.replaceChildren(h)})),this.currentRoute=o.route,this.updateActiveLink()}updateActiveLink(){for(const[e,n]of this.navigationLinks.entries())e===this.currentRoute?.props.path?n.classList.add("active"):n.classList.remove("active")}findRoute(e){for(const[n,r]of this.urlPatterns.entries()){const o=n.exec({pathname:e.pathname});if(o)return{route:r,params:o.pathname.groups}}}push(e){this.adapter.navigate(e)}replace(e){this.adapter.navigate(e,!0)}back(){this.adapter.go(-1)}forward(){this.adapter.go(1)}getUnsafe(e){const n=this.routes.get(e.path);if(!n){console.warn("[getUnsafe] Route not found:",e);return}return n}}function X(t){return new Q(t)}class L{el;props;constructor(e){this.props=e}}class Y extends L{constructor(){super({path:"/about",label:"About"})}render(e){return i("div",[i("h1","About Page"),i("p","This is the about page."),e.query.timestamp?i("p",`Timestamp: ${e.query.timestamp}`):"",i("button",{onclick(){e.router.back()}},"Go back")])}}class _ extends L{constructor(){super({path:"/blog/:id"})}render(e){const n=e.params.id;return i("div",[i("h1","Blog Page"),i("p",`Blog ID: ${n}`),i("div",{className:"buttons"},[i("button",{onclick(){e.router.back()}},"Go back"),i("button",{onclick(){e.router.push(`/blog/${Number(n)+1}`)}},"Go to next blog")])])}}class z extends L{cursorPointer;constructor(){super({path:"/",label:"Home"}),this.handleClick=this.handleClick.bind(this),this.handleMove=this.handleMove.bind(this)}setup(){this.cursorPointer=i("pre","x: 0 y: 0"),document.body.addEventListener("mousemove",this.handleMove)}render(e){return i("div",[i("h1","Home Page"),i("p","Welcome back!"),this.cursorPointer,i("div",{className:"buttons"},[i("button",{onclick:this.handleClick},"Click me!"),i("button",{onclick:()=>{e.router.push(`/about?timestamp=${Date.now()}`)}},"Go to About"),i("button",{onclick:()=>{e.router.push("/blog/1")}},"Go to Blog")])])}unmount(){document.body.removeEventListener("mousemove",this.handleMove)}handleClick(){console.info("Home clicked!")}handleMove(e){this.cursorPointer.textContent=`x: ${e.clientX} y: ${e.clientY}`,console.log("Mouse moved! ðŸŽ‰")}}class J extends L{posts=x([]);loading=x(!1);page=x(1);abortController;constructor(){super({path:"/posts",label:"Posts"})}setup(){this.fetchPosts()}render(){const e=this.posts(),n=this.page(),r=this.loading(),o=e.map(u=>i("tr",[i("td",String(u.id)),i("td",String(u.userId)),i("td",u.title),i("td",u.body)]));return i("div",[i("h1","Posts"),i("div",{className:"buttons"},[i("button",{disabled:n===1,onclick:()=>{this.page(n-1),this.fetchPosts()}},"Previous Page"),i("span",`Page: ${n}`),i("button",{disabled:n===10,onclick:()=>{this.page(n+1),this.fetchPosts()}},"Next Page"),r?i("span","Loading..."):"",i("button",{style:{marginLeft:"auto"},onclick:()=>{this.posts([{id:Math.floor(Math.random()*100),userId:1,title:"qui est esse",body:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Quas, quia."},...e])}},"Add Post")]),i("table",{className:"posts-table"},[i("thead",[i("tr",[i("th","ID"),i("th","User ID"),i("th","Title"),i("th","Body")])]),i("tbody",o)])])}unmount(){this.abortRequestPosts()}abortRequestPosts(){this.abortController&&(this.abortController.abort(),this.abortController=void 0)}async fetchPosts(){this.abortRequestPosts(),this.abortController=new AbortController,this.loading(!0);try{const e=await fetch(`https://jsonplaceholder.typicode.com/posts?_page=${this.page()}`,{signal:this.abortController.signal});e.ok&&(this.posts(await e.json()),this.abortController=void 0),this.loading(!1)}catch{}}onLinkMouseEnter(){console.log("Mouse enter!")}onLinkMouseLeave(){console.log("Mouse leave!")}}const E=X({adapter:new I,routes:[z,Y,_,J],renderRoot:()=>document.querySelector("#app"),navigationRoot:()=>document.querySelector("#navigation"),navigationRenderLink:()=>i("a",{className:"link"})});console.log(E);window.$router=E;
